{"ast":null,"code":"var _jsxFileName = \"/Users/flatironschool/dev/mod5-project/best-offer/best-offer-frontend/src/App.js\";\nimport React from \"react\";\nimport \"./App.css\";\nimport 'semantic-ui-css/semantic.min.css';\nimport \"./App.sass\";\nimport Login from \"./components/Login\";\nimport ProfileContainer from \"./containers/ProfileContainer\";\nimport ContractorProfileContainer from \"./containers/ContractorProfileContainer\";\nimport ContractorsContainer from \"./containers/ContractorsContainer\";\nimport TaskShowPage from \"./components/TaskShowPage\"; // import ContractorShowPage from \"./components/ContractorShowPage\"\n\nimport { isEmpty } from \"lodash\";\nimport { Link } from 'react-router-dom';\nimport { // eslint-disable-next-line\nBrowserRouter as Router, Route, Switch, Redirect } from \"react-router-dom\"; // import ContractorShowPage from \"./components/ContractorShowPage\";\n\nconst specialties = [\"gardening\", \"plumbing\", \"technology\", \"electrician\", \"carpentry\"];\nconst URL = \"http://localhost:3000/api/v1/login/\";\nconst CONTRACTOR_URL = \"http://localhost:3000/api/v1/login/contractors\";\nconst PROFILE_URL = 'http://localhost:3000/api/v1/profile/';\nconst TASKS = \"http://localhost:3000/tasks/\";\nexport default class App extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      currentUser: {},\n      loading: true,\n      removeTask: true,\n      tasks: {},\n      currentContractor: {}\n    };\n\n    this.updateUser = user => {\n      this.setState({\n        currentUser: user,\n        loading: false,\n        tasks: user.tasks\n      });\n    };\n\n    this.logout = () => {\n      localStorage.clear();\n      this.setState({\n        currentUser: {},\n        currentContractor: {}\n      });\n    };\n\n    this.componentDidMount = () => {\n      if (localStorage.getItem(\"token\")) {\n        fetch(URL + (localStorage.getItem(\"contractor\") ? 'contractor' : \"\"), {\n          headers: {\n            \"Authentication\": \"Bearer \".concat(localStorage.getItem(\"token\"))\n          }\n        }).then(res => res.json()).then(res => {\n          localStorage.getItem(\"contractor\") ? 'contractor' : \"\";\n          this.updateUser(res);\n        });\n      } else {\n        this.setState({\n          loading: false\n        });\n      }\n    };\n\n    this.handleUser = (event, newUser, contractors) => {\n      event.preventDefault();\n      let contractor;\n\n      if (contractors) {\n        contractor = 'contractor';\n      }\n\n      let data = {\n        name: event.target.name.value,\n        password: event.target.password.value,\n        new_user: newUser\n      };\n      fetch(URL + (contractors ? contractor : \"\"), {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(data)\n      }).then(res => res.json()).then(data => {\n        console.log(data);\n\n        if (data.authenticated && contractor == \"contractor\") {\n          localStorage.setItem(\"token\", data.token);\n          localStorage.setItem(\"contractor\", true);\n          this.setState({\n            currentContractor: JSON.parse(data.user)\n          });\n        } else {\n          if (data.authenticated) {\n            localStorage.setItem(\"contractor\", false);\n            localStorage.setItem(\"token\", data.token);\n            this.setState({\n              currentUser: JSON.parse(data.user)\n            });\n          }\n        }\n      });\n    };\n\n    this.acceptBid = (bid, task) => {\n      if (!bid.status) {\n        let data = {\n          task: {\n            id: task.id,\n            task_done: true,\n            user_id: this.state.currentUser.id,\n            bids_attributes: {\n              id: bid.id,\n              status: true\n            }\n          }\n        };\n        fetch(\"http://localhost:3000/tasks/\".concat(task.id), {\n          method: 'PATCH',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(data)\n        }).then(res => res.json()).then(currentUser => this.setState({\n          currentUser\n        }));\n      }\n    };\n\n    this.addTask = event => {\n      event.preventDefault();\n      let data = {\n        name: event.target.headline.value,\n        description: event.target.description.value,\n        specialty_id: event.target.specialty.value,\n        user_id: this.state.currentUser.id\n      };\n      event.target.reset();\n      fetch(TASKS, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(data)\n      }).then(res => res.json()).then(currentUser => {\n        console.log('end', currentUser);\n        let updateUser = this.state.currentUser;\n        updateUser.tasks = currentUser.tasks;\n        this.setState({\n          currentUser: updateUser\n        });\n      });\n    };\n\n    this.deleteBid = bid => {\n      let data = {\n        id: bid.id,\n        user_id: this.state.currentUser.id\n      };\n      fetch(\"http://localhost:3000/bids/\".concat(bid.id), {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(data)\n      }).then(res => res.json()).then(currentUser => {\n        this.updateUser(currentUser);\n      });\n    };\n\n    this.deleteTask = task => {\n      let data = {\n        id: task.id,\n        user_id: this.state.currentUser.id\n      };\n      fetch(\"http://localhost:3000/tasks/\".concat(task.id), {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(data)\n      }).then(res => res.json()).then(updatedUser => {\n        let updateUser = this.state.currentUser;\n        let currentUserTasks = updateUser.tasks.filter(t => t.id !== task.id);\n        updateUser.tasks = currentUserTasks;\n        this.setState({\n          currentUser: updateUser\n        });\n      });\n    };\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"App\",\n      style: {\n        height: '50vh'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231\n      },\n      __self: this\n    }, \"BEST OFFER OR ELSE\"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232\n      },\n      __self: this\n    }, !isEmpty(this.state.currentUser) ? React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/profile\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234\n      },\n      __self: this\n    }, \" \", React.createElement(\"button\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234\n      },\n      __self: this\n    }, \"To Profile Page\")), React.createElement(Link, {\n      to: \"/contractors\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235\n      },\n      __self: this\n    }, \" \", React.createElement(\"button\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235\n      },\n      __self: this\n    }, \"View Contractors\")), React.createElement(\"button\", {\n      onClick: this.logout,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236\n      },\n      __self: this\n    }, \"Logout\")) : null), !this.state.loading ? React.createElement(Switch, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241\n      },\n      __self: this\n    }, React.createElement(Route, {\n      exact: true,\n      path: \"/login\",\n      render: props => !isEmpty(this.state.currentUser) ? React.createElement(Redirect, {\n        to: \"/profile\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 247\n        },\n        __self: this\n      }) : React.createElement(Login, {\n        handleUser: this.handleUser,\n        newUser: false,\n        contractor: false,\n        routerProps: props,\n        contractor: false,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 249\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/login/contractor\",\n      render: props => !isEmpty(this.state.currentUser) ? React.createElement(Redirect, {\n        to: \"/contractor\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 259\n        },\n        __self: this\n      }) : React.createElement(Login, {\n        handleUser: this.handleUser,\n        newUser: false,\n        contractor: true,\n        routerProps: props,\n        contractor: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 261\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/signup/contractor\",\n      render: props => !isEmpty(this.state.currentUser) ? React.createElement(Redirect, {\n        to: \"/contractor\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 271\n        },\n        __self: this\n      }) : React.createElement(Login, {\n        handleUser: this.handleUser,\n        newUser: false,\n        contractor: true,\n        routerProps: props,\n        newUser: true,\n        contractor: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 273\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 266\n      },\n      __self: this\n    }), React.createElement(Route, {\n      exact: true,\n      path: \"/signup\",\n      render: props => !isEmpty(this.state.currentUser) ? React.createElement(Redirect, {\n        to: \"/profile\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 283\n        },\n        __self: this\n      }) : React.createElement(Login, {\n        handleUser: this.handleUser,\n        newUser: true,\n        routerProps: props,\n        contractor: false,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 285\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278\n      },\n      __self: this\n    }), !isEmpty(this.state.currentUser) ? React.createElement(Route, {\n      exact: true,\n      path: \"/task/:id\",\n      render: props => {\n        let taskObj = this.state.currentUser.tasks.find(task => task.id == props.match.params.id);\n        return !isEmpty(taskObj) ? React.createElement(TaskShowPage, {\n          task: taskObj,\n          acceptBid: this.acceptBid,\n          deleteBid: this.deleteBid,\n          deleteTask: this.deleteTask,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 299\n          },\n          __self: this\n        }) : React.createElement(Redirect, {\n          to: \"/profile\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 307\n          },\n          __self: this\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 294\n      },\n      __self: this\n    }) : React.createElement(Redirect, {\n      to: \"/login\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 312\n      },\n      __self: this\n    }), React.createElement(Route, {\n      exact: true,\n      path: \"/profile\",\n      render: () => !isEmpty(this.state.currentUser) ? React.createElement(ProfileContainer, {\n        user: this.state.currentUser,\n        specialties: specialties,\n        tasks: this.state.tasks,\n        addTask: this.addTask,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 325\n        },\n        __self: this\n      }) : React.createElement(Redirect, {\n        to: \"/login\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 332\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 320\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/contractor\",\n      render: () => !isEmpty(this.state.currentUser) ? React.createElement(ContractorProfileContainer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 340\n        },\n        __self: this\n      }) : React.createElement(Redirect, {\n        to: \"/login/contractor\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 343\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 335\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/contractors\",\n      render: routerProps => {\n        return React.createElement(ContractorsContainer, Object.assign({\n          user: this.state.currentUser,\n          specialties: specialties,\n          currentTask: this.currentTask\n        }, routerProps, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 352\n          },\n          __self: this\n        }));\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 349\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/\",\n      render: () => React.createElement(Redirect, {\n        to: \"/login\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 360\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 360\n      },\n      __self: this\n    })) : null);\n  }\n\n}","map":{"version":3,"sources":["/Users/flatironschool/dev/mod5-project/best-offer/best-offer-frontend/src/App.js"],"names":["React","Login","ProfileContainer","ContractorProfileContainer","ContractorsContainer","TaskShowPage","isEmpty","Link","BrowserRouter","Router","Route","Switch","Redirect","specialties","URL","CONTRACTOR_URL","PROFILE_URL","TASKS","App","Component","state","currentUser","loading","removeTask","tasks","currentContractor","updateUser","user","setState","logout","localStorage","clear","componentDidMount","getItem","fetch","headers","then","res","json","handleUser","event","newUser","contractors","preventDefault","contractor","data","name","target","value","password","new_user","method","body","JSON","stringify","console","log","authenticated","setItem","token","parse","acceptBid","bid","task","status","id","task_done","user_id","bids_attributes","addTask","headline","description","specialty_id","specialty","reset","deleteBid","deleteTask","updatedUser","currentUserTasks","filter","t","render","height","props","taskObj","find","match","params","routerProps","currentTask"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport \"./App.css\";\nimport 'semantic-ui-css/semantic.min.css'\nimport \"./App.sass\";\nimport Login from \"./components/Login\";\nimport ProfileContainer from \"./containers/ProfileContainer\";\nimport ContractorProfileContainer from \"./containers/ContractorProfileContainer\";\nimport ContractorsContainer from \"./containers/ContractorsContainer\";\nimport TaskShowPage from \"./components/TaskShowPage\";\n// import ContractorShowPage from \"./components/ContractorShowPage\"\nimport { isEmpty } from \"lodash\";\nimport {Link} from 'react-router-dom'\n\nimport {\n  // eslint-disable-next-line\n  BrowserRouter as Router,\n  Route,\n  Switch,\n  Redirect\n} from \"react-router-dom\";\n// import ContractorShowPage from \"./components/ContractorShowPage\";\nconst specialties = [\n  \"gardening\",\n  \"plumbing\",\n  \"technology\",\n  \"electrician\",\n  \"carpentry\"\n];\nconst URL = \"http://localhost:3000/api/v1/login/\";\nconst CONTRACTOR_URL = \"http://localhost:3000/api/v1/login/contractors\"\nconst PROFILE_URL = 'http://localhost:3000/api/v1/profile/'\nconst TASKS = \"http://localhost:3000/tasks/\";\n\nexport default class App extends React.Component {\n  state = {\n    currentUser: {}, \n    loading: true,\n    removeTask: true,\n    tasks: {},\n    currentContractor: {}\n   \n  };\n\n \n\n  updateUser = (user) => {\n    this.setState({\n      currentUser: user, \n      loading: false,\n      tasks: user.tasks\n    })\n  }\n\n\n\n  logout = () => {\n    localStorage.clear()\n    this.setState({\n      currentUser: {},\n      currentContractor: {}\n    })\n  };\n\n  componentDidMount = () => {\n    if(localStorage.getItem(\"token\")){\n      \n      fetch(URL + (localStorage.getItem(\"contractor\") ? 'contractor' : \"\"), {\n        headers: { \"Authentication\": \n        `Bearer ${localStorage.getItem(\"token\")}` \n        }\n      }\n      )\n      .then(res => res.json())\n      .then(res => {\n        localStorage.getItem(\"contractor\") ? 'contractor' : \"\"\n        this.updateUser(res)})\n    }\n    else{\n      this.setState({loading: false})\n    }\n  }\n\n\n  handleUser = (event, newUser, contractors) => {\n    event.preventDefault();\n    let contractor\n      if(contractors){\n           contractor = 'contractor' \n          }\n     \n  \n    let data = {\n      name: event.target.name.value, \n      password: event.target.password.value,\n      new_user: newUser\n    }\n\n       \n    fetch(URL + (contractors ? contractor : \"\"), {\n      method: 'POST', \n      headers: { \n        'Content-Type': 'application/json'\n      }, \n      body: JSON.stringify(data)\n    })\n      .then(res => res.json())\n      .then(data => {\n          console.log(data)\n          \n         if (data.authenticated && contractor == \"contractor\"){\n            localStorage.setItem(\"token\", data.token)\n            localStorage.setItem(\"contractor\", true)\n\n            this.setState({\n              currentContractor: JSON.parse(data.user)\n            })}\n            else  {\n              if (data.authenticated){\n            localStorage.setItem(\"contractor\", false)\n            localStorage.setItem(\"token\", data.token)\n                      this.setState({\n                        currentUser: JSON.parse(data.user)\n                      })}}\n          })  ;\n  };\n\n  acceptBid = (bid, task) => {\n    \n    if(!bid.status){\n      let data = {\n        task:{\n        id: task.id,\n        task_done: true,\n        user_id: this.state.currentUser.id,\n        bids_attributes:\n            {\n            id: bid.id, \n            status: true\n            }\n        }\n      }\n      \n      \n    fetch(`http://localhost:3000/tasks/${task.id}`, {\n      method: 'PATCH', \n      headers: { \n        'Content-Type': 'application/json'\n      }, \n      body: JSON.stringify(data)\n    })\n    .then(res => res.json())\n    .then(currentUser => this.setState({currentUser}))\n    }\n  \n  }\n\n  addTask = (event) => {\n    \n    event.preventDefault();\n    let data = {\n      name: event.target.headline.value,\n      description: event.target.description.value,\n      specialty_id: event.target.specialty.value,\n      user_id: this.state.currentUser.id\n    };\n    event.target.reset();\n    \n    fetch(TASKS, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(data)\n    })\n      .then(res => res.json())\n      .then(currentUser =>{\n        console.log('end', currentUser)\n        let updateUser = this.state.currentUser\n        updateUser.tasks = currentUser.tasks\n        this.setState({\n          currentUser : updateUser\n        })}\n      );\n  };\n\n\n\n  deleteBid = (bid) =>{\n    let data = {\n      id: bid.id,\n      user_id: this.state.currentUser.id\n    }\n    fetch(`http://localhost:3000/bids/${bid.id}`, {\n      method: 'DELETE', \n      headers: { \n        'Content-Type': 'application/json'\n      }, \n      body: JSON.stringify(data)\n    })\n    .then(res => res.json())\n    .then(currentUser => {\n      \n    this.updateUser(currentUser)\n    })\n  }\n\n  deleteTask = (task) =>{\n\n    let data = {\n      id: task.id,\n      user_id: this.state.currentUser.id\n    }\n    fetch(`http://localhost:3000/tasks/${task.id}`, {\n      method: 'DELETE', \n      headers: { \n        'Content-Type': 'application/json'\n      }, \n      body: JSON.stringify(data)\n    })\n    .then(res => res.json())\n    .then(updatedUser => {\n      let updateUser = this.state.currentUser\n      let currentUserTasks = updateUser.tasks.filter(t => t.id !== task.id)\n      updateUser.tasks = currentUserTasks\n      this.setState({\n        currentUser: updateUser\n      })})\n  }\n\n  render() {\n    return (\n      <div className=\"App\" style={{height: '50vh'}}>\n        <h1>BEST OFFER OR ELSE</h1>\n        <p>\n          {!isEmpty(this.state.currentUser) ? <React.Fragment> \n            <Link to='/profile'> <button>To Profile Page</button></Link>\n            <Link to='/contractors'> <button>View Contractors</button></Link>  \n            <button onClick={this.logout}>Logout</button>\n          </React.Fragment>\n        : null\n        }\n        </p>\n        {!this.state.loading ? <Switch>\n          <Route\n            exact\n            path=\"/login\"\n            render={(props) =>\n              !isEmpty(this.state.currentUser) ? (\n                <Redirect to=\"/profile\" />\n              ) : (\n                <Login handleUser={this.handleUser} newUser={false} contractor={false} routerProps={props} contractor={false}/>\n              )\n            }\n          />\n\n          <Route\n            \n            path=\"/login/contractor\"\n            render={(props) =>\n              !isEmpty(this.state.currentUser) ? (\n                <Redirect to=\"/contractor\" />\n              ) : (\n                <Login handleUser={this.handleUser} newUser={false} contractor={true} routerProps={props} contractor={true}/>\n              )\n            }\n          />\n\n            <Route\n            \n            path=\"/signup/contractor\"\n            render={(props) =>\n              !isEmpty(this.state.currentUser) ? (\n                <Redirect to=\"/contractor\" />\n              ) : (\n                <Login handleUser={this.handleUser} newUser={false} contractor={true} routerProps={props} newUser={true} contractor={true}/>\n              )\n            }\n          />\n          \n          <Route\n            exact\n            path=\"/signup\"\n            render={(props) =>\n              !isEmpty(this.state.currentUser) ? (\n                <Redirect to=\"/profile\" />\n              ) : (\n                <Login handleUser={this.handleUser} newUser={true} routerProps={props} contractor={false}/>\n              )\n            }\n          />\n\n          \n          \n\n            {!isEmpty(this.state.currentUser) ?\n              <Route exact \n                path=\"/task/:id\"\n                render={(props) =>{  \n                 let taskObj =  this.state.currentUser.tasks.find(task => task.id == props.match.params.id) \n                  return   !isEmpty(taskObj) ?\n                  <TaskShowPage\n                      task={taskObj}\n                     \n                      acceptBid={this.acceptBid}\n                      deleteBid={this.deleteBid}\n                      deleteTask={this.deleteTask}\n                  />\n                  :\n                  <Redirect to=\"/profile\" />\n                    \n                }}/>\n              :\n              \n              <Redirect to=\"/login\" />\n              \n              \n              }\n\n\n\n\n          <Route\n            exact\n            path=\"/profile\"\n            render={() =>\n              !isEmpty(this.state.currentUser) ? (\n                <ProfileContainer\n                  user={this.state.currentUser}\n                  specialties={specialties}\n                  tasks={this.state.tasks}\n                  addTask={this.addTask}\n                />\n              ) : \n                <Redirect to=\"/login\" />\n              }/>\n\n          <Route\n            \n            path=\"/contractor\"\n            render={() =>\n              !isEmpty(this.state.currentUser) ? (\n                <ContractorProfileContainer\n                />\n              ) : \n                <Redirect to=\"/login/contractor\" />\n              }/>\n            \n            \n     \n\n            <Route \n                   path='/contractors' render={(routerProps) =>{  \n                  \n              return  <ContractorsContainer\n                  user={this.state.currentUser}\n                  specialties={specialties}\n                  currentTask={this.currentTask}\n                 {...routerProps}\n            />}}/>\n\n\n          <Route path=\"/\" render={() => <Redirect to=\"/login\" />} />\n        </Switch> : null}\n      </div>\n    );\n  }\n}\n\n\n\n\n\n\n"]},"metadata":{},"sourceType":"module"}